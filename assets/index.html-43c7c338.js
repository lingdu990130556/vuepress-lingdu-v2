import{_ as a,o as e,c as t,f as s,h as p,b as n,d as l}from"./app-ac465cee.js";const o={},i=s("h1",{id:"seata",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#seata","aria-hidden":"true"},"#"),p(" seata")],-1),c=s("div",{class:"gpt_html_div"},[s("div",{id:"scrollRef",class:"h-full overflow-hidden overflow-y-auto"},[s("div",{id:"image-wrapper",class:"w-full max-w-screen-xl m-auto dark:bg-[#101014] p-4"},[n("问"),s("div",{class:"flex w-full mb-6 overflow-hidden flex-row-reverse"},[s("div",{class:"flex items-center justify-center flex-shrink-0 h-8 overflow-hidden rounded-full basis-8 ml-2"},[s("span",{class:"n-avatar",style:{"--n-font-size":"14px","--n-border":"none","--n-border-radius":"3px","--n-color":"rgba(204, 204, 204, 1)","--n-color-modal":"rgba(204, 204, 204, 1)","--n-color-popover":"rgba(204, 204, 204, 1)","--n-bezier":"cubic-bezier(0.4, 0, 0.2, 1)","--n-merged-size":"var(--n-avatar-size-override, 34px)"}},[s("img",{loading:"eager",src:"http://lingdu990130556.gitee.io/vuepress-lingdu-v2/img/logo.png","data-image-src":"http://lingdu990130556.gitee.io/vuepress-lingdu-v2/img/logo.png"}),n("")])]),s("div",{class:"overflow-hidden text-sm items-end"},[s("p",{class:"text-xs text-[#b4bbc4] text-right"},"2023/8/7 17:38:20"),s("div",{class:"flex items-end gap-1 mt-2 flex-row-reverse"},[s("div",{class:"text-black text-wrap min-w-[20px] rounded-md px-3 py-2 bg-[#d2f9d1] dark:bg-[#a1dc95]"},[s("div",{class:"leading-relaxed break-words"},[s("div",{class:"whitespace-pre-wrap"},"seata")])]),s("div",{class:"flex flex-col"},[n(""),n(""),s("button",{class:"transition text-neutral-300 hover:text-neutral-800 dark:hover:text-neutral-200"},[s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--ri",width:"1em",height:"1em",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M12 3c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0 14c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Z"})])]),n("")])])])]),n("答"),s("div",{class:"flex w-full mb-6 overflow-hidden"},[s("div",{class:"flex items-center justify-center flex-shrink-0 h-8 overflow-hidden rounded-full basis-8 mr-2"},[s("span",{class:"text-[28px] dark:text-white"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-hidden":"true",width:"1em",height:"1em"},[s("path",{d:"M29.71,13.09A8.09,8.09,0,0,0,20.34,2.68a8.08,8.08,0,0,0-13.7,2.9A8.08,8.08,0,0,0,2.3,18.9,8,8,0,0,0,3,25.45a8.08,8.08,0,0,0,8.69,3.87,8,8,0,0,0,6,2.68,8.09,8.09,0,0,0,7.7-5.61,8,8,0,0,0,5.33-3.86A8.09,8.09,0,0,0,29.71,13.09Zm-12,16.82a6,6,0,0,1-3.84-1.39l.19-.11,6.37-3.68a1,1,0,0,0,.53-.91v-9l2.69,1.56a.08.08,0,0,1,.05.07v7.44A6,6,0,0,1,17.68,29.91ZM4.8,24.41a6,6,0,0,1-.71-4l.19.11,6.37,3.68a1,1,0,0,0,1,0l7.79-4.49V22.8a.09.09,0,0,1,0,.08L13,26.6A6,6,0,0,1,4.8,24.41ZM3.12,10.53A6,6,0,0,1,6.28,7.9v7.57a1,1,0,0,0,.51.9l7.75,4.47L11.85,22.4a.14.14,0,0,1-.09,0L5.32,18.68a6,6,0,0,1-2.2-8.18Zm22.13,5.14-7.78-4.52L20.16,9.6a.08.08,0,0,1,.09,0l6.44,3.72a6,6,0,0,1-.9,10.81V16.56A1.06,1.06,0,0,0,25.25,15.67Zm2.68-4-.19-.12-6.36-3.7a1,1,0,0,0-1.05,0l-7.78,4.49V9.2a.09.09,0,0,1,0-.09L19,5.4a6,6,0,0,1,8.91,6.21ZM11.08,17.15,8.38,15.6a.14.14,0,0,1-.05-.08V8.1a6,6,0,0,1,9.84-4.61L18,3.6,11.61,7.28a1,1,0,0,0-.53.91ZM12.54,14,16,12l3.47,2v4L16,20l-3.47-2Z",fill:"currentColor"})])])]),s("div",{class:"overflow-hidden text-sm items-start"},[s("p",{class:"text-xs text-[#b4bbc4] text-left"},"2023/8/7 17:38:43"),s("div",{class:"flex items-end gap-1 mt-2 flex-row"},[s("div",{class:"text-black text-wrap min-w-[20px] rounded-md px-3 py-2 bg-[#f4f6f8] dark:bg-[#1e1e20]"},[s("div",{class:"leading-relaxed break-words"},[s("div",{class:"markdown-body"},[s("p",null,"Seata（Simple Extensible Autonomous Transaction Architecture）是一个开源的分布式事务解决方案，旨在简化分布式事务的开发和管理。Seata可以支持各种数据库和应用框架，为分布式系统提供强一致性的事务支持。"),s("p",null,"Seata的主要特点和功能包括："),s("ol",null,[s("li",null,"分布式事务支持：Seata提供了对分布式事务的完整支持，可以保证多个参与者之间的操作具有原子性、一致性、隔离性和持久性（ACID）。"),s("li",null,"高性能：Seata通过优化资源管理和事务日志存储等方式，提供了高效的分布式事务处理能力，降低了性能开销。"),s("li",null,"支持多种数据存储：Seata支持主流的关系型数据库，如MySQL、Oracle、PostgreSQL等，并提供了对NoSQL数据库的扩展支持。"),s("li",null,"透明化接入：Seata提供了透明化接入的能力，不需要修改现有业务逻辑代码，只需简单配置即可实现分布式事务的管理。"),s("li",null,"高可用性和容错性：Seata提供了高可用的架构设计和容错机制，支持故障自动切换和恢复，保证分布式事务的可靠性。"),s("li",null,"多模式事务：Seata支持全局事务（Global Transaction）和本地事务（Branch Transaction）两种模式，适用于不同的场景和需求。"),s("li",null,"分布式事务解决方案集成：Seata可以与Spring Cloud、Dubbo、gRPC等分布式微服务框架无缝集成，提供全面的分布式事务解决方案。")]),s("p",null,"Seata是一个开源且活跃的项目，得到了广泛的社区支持和贡献。它的目标是帮助开发者更好地处理分布式事务问题，提供简单、可靠和高性能的分布式事务解决方案。在大规模分布式系统中，使用Seata可以有效地解决分布式事务的一致性和可靠性问题，提升系统的稳定性和可用性。")])])]),s("div",{class:"flex flex-col"},[s("button",{class:"mb-2 transition text-neutral-300 hover:text-neutral-800 dark:hover:text-neutral-300"},[s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--ri",width:"1em",height:"1em",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795Z"})])]),n(""),s("button",{class:"transition text-neutral-300 hover:text-neutral-800 dark:hover:text-neutral-200"},[s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--ri",width:"1em",height:"1em",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M12 3c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0 14c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2Z"})])]),n("")])])])])])])],-1),r=l(`<h2 id="_1-下载" tabindex="-1"><a class="header-anchor" href="#_1-下载" aria-hidden="true">#</a> 1.下载</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 官网地址</span>
http://seata.io/zh-cn/docs/user/configurations.html
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-解压" tabindex="-1"><a class="header-anchor" href="#_2-解压" aria-hidden="true">#</a> 2.解压</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 解压</span>
<span class="token function">unzip</span> seata-server-1.4.0.zip
<span class="token comment"># 进入seata目录</span>
<span class="token builtin class-name">cd</span> seata
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-在seata目录下新建config-txt文件-第一次使用需要此文件初始化配置到nacos中" tabindex="-1"><a class="header-anchor" href="#_3-在seata目录下新建config-txt文件-第一次使用需要此文件初始化配置到nacos中" aria-hidden="true">#</a> 3.在seata目录下新建config.txt文件(第一次使用需要此文件初始化配置到nacos中)</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@sizx153 seata<span class="token punctuation">]</span><span class="token comment"># vim config.txt</span>
<span class="token punctuation">[</span>root@sjzx153 seata<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="config-txt" tabindex="-1"><a class="header-anchor" href="#config-txt" aria-hidden="true">#</a> config.txt</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ervice.vgroupMapping.jsxy-system-group<span class="token operator">=</span>default
service.vgroupMapping.sjzx-dimensiondoor-group<span class="token operator">=</span>default
<span class="token assign-left variable">store.mode</span><span class="token operator">=</span>db
<span class="token assign-left variable">store.db.datasource</span><span class="token operator">=</span>druid
<span class="token assign-left variable">store.db.dbType</span><span class="token operator">=</span>mysql
<span class="token assign-left variable">store.db.driverClassName</span><span class="token operator">=</span>com.mysql.jdbc.Driver
<span class="token assign-left variable">store.db.url</span><span class="token operator">=</span>jdbc:mysql://192.168.0.151:3306/seata?useUnicode<span class="token operator">=</span>true
<span class="token assign-left variable">store.db.user</span><span class="token operator">=</span>root
<span class="token assign-left variable">store.db.password</span><span class="token operator">=</span>root
<span class="token assign-left variable">store.db.minConn</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">store.db.maxConn</span><span class="token operator">=</span><span class="token number">30</span>
<span class="token assign-left variable">store.db.globalTable</span><span class="token operator">=</span>global_table
<span class="token assign-left variable">store.db.branchTable</span><span class="token operator">=</span>branch_table
<span class="token assign-left variable">store.db.queryLimit</span><span class="token operator">=</span><span class="token number">100</span>
<span class="token assign-left variable">store.db.lockTable</span><span class="token operator">=</span>lock_table
<span class="token assign-left variable">store.db.maxWait</span><span class="token operator">=</span><span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-到conf目录下修改registry-conf文件" tabindex="-1"><a class="header-anchor" href="#_4-到conf目录下修改registry-conf文件" aria-hidden="true">#</a> 4.到conf目录下修改registry.conf文件</h2><h3 id="注意-在这之前先在nacos中新建一个命名空间-seata" tabindex="-1"><a class="header-anchor" href="#注意-在这之前先在nacos中新建一个命名空间-seata" aria-hidden="true">#</a> 注意，在这之前先在nacos中新建一个命名空间 SEATA</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>registry <span class="token punctuation">{</span>
  <span class="token comment"># file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span>
  <span class="token builtin class-name">type</span> <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>
  loadBalance <span class="token operator">=</span> <span class="token string">&quot;RandomLoadBalance&quot;</span>
  loadBalanceVirtualNodes <span class="token operator">=</span> <span class="token number">10</span>

  nacos <span class="token punctuation">{</span>
    application <span class="token operator">=</span> <span class="token string">&quot;seata-server&quot;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;192.168.0.153:8848,192.168.0.152:8848,192.168.0.151:8848&quot;</span>
    group <span class="token operator">=</span> <span class="token string">&quot;SEATA_GROUP&quot;</span>
    namespace <span class="token operator">=</span> <span class="token string">&quot;SEATA&quot;</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    username <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>
    password <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>
  <span class="token punctuation">}</span>
  eureka <span class="token punctuation">{</span>
    serviceUrl <span class="token operator">=</span> <span class="token string">&quot;http://localhost:8761/eureka&quot;</span>
    application <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    weight <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
  redis <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;localhost:6379&quot;</span>
    db <span class="token operator">=</span> <span class="token number">0</span>
    password <span class="token operator">=</span> <span class="token string">&quot;redis&quot;</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    <span class="token function">timeout</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  zk <span class="token punctuation">{</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:2181&quot;</span>
    sessionTimeout <span class="token operator">=</span> <span class="token number">6000</span>
    connectTimeout <span class="token operator">=</span> <span class="token number">2000</span>
    username <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    password <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
  consul <span class="token punctuation">{</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:8500&quot;</span>
  <span class="token punctuation">}</span>
  etcd3 <span class="token punctuation">{</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;http://localhost:2379&quot;</span>
  <span class="token punctuation">}</span>
  sofa <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:9603&quot;</span>
    application <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    region <span class="token operator">=</span> <span class="token string">&quot;DEFAULT_ZONE&quot;</span>
    datacenter <span class="token operator">=</span> <span class="token string">&quot;DefaultDataCenter&quot;</span>
    cluster <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span>
    group <span class="token operator">=</span> <span class="token string">&quot;SEATA_GROUP&quot;</span>
    addressWaitTime <span class="token operator">=</span> <span class="token string">&quot;3000&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token function">file</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">&quot;file.conf&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

config <span class="token punctuation">{</span>
  <span class="token comment"># file、nacos 、apollo、zk、consul、etcd3</span>
  <span class="token builtin class-name">type</span> <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>

  nacos <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;192.168.0.153:8848,192.168.0.152:8848,192.168.0.151:8848&quot;</span>
    namespace <span class="token operator">=</span> <span class="token string">&quot;SEATA&quot;</span>
    group <span class="token operator">=</span> <span class="token string">&quot;SEATA_GROUP&quot;</span>
    username <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>
    password <span class="token operator">=</span> <span class="token string">&quot;nacos&quot;</span>
  <span class="token punctuation">}</span>
  consul <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:8500&quot;</span>
  <span class="token punctuation">}</span>
  apollo <span class="token punctuation">{</span>
    appId <span class="token operator">=</span> <span class="token string">&quot;seata-server&quot;</span>
    apolloMeta <span class="token operator">=</span> <span class="token string">&quot;http://192.168.1.204:8801&quot;</span>
    namespace <span class="token operator">=</span> <span class="token string">&quot;application&quot;</span>
    apolloAccesskeySecret <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
  zk <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:2181&quot;</span>
    sessionTimeout <span class="token operator">=</span> <span class="token number">6000</span>
    connectTimeout <span class="token operator">=</span> <span class="token number">2000</span>
    username <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    password <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
  etcd3 <span class="token punctuation">{</span>
    serverAddr <span class="token operator">=</span> <span class="token string">&quot;http://localhost:2379&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token function">file</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">&quot;file.conf&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-在conf文件夹下新建nacos-config-sh文件" tabindex="-1"><a class="header-anchor" href="#_5-在conf文件夹下新建nacos-config-sh文件" aria-hidden="true">#</a> 5.在conf文件夹下新建nacos-config.sh文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>
<span class="token comment"># Copyright 1999-2019 Seata.io Group.</span>
<span class="token comment">#</span>
<span class="token comment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="token comment"># you may not use this file except in compliance with the License.</span>
<span class="token comment"># You may obtain a copy of the License at、</span>
<span class="token comment">#</span>
<span class="token comment">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="token comment">#</span>
<span class="token comment"># Unless required by applicable law or agreed to in writing, software</span>
<span class="token comment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="token comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="token comment"># See the License for the specific language governing permissions and</span>
<span class="token comment"># limitations under the License.</span>

<span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> <span class="token string">&quot;:h:p:g:t:u:w:&quot;</span> opt
<span class="token keyword">do</span>
  <span class="token keyword">case</span> <span class="token variable">$opt</span> <span class="token keyword">in</span>
  h<span class="token punctuation">)</span>
    <span class="token assign-left variable">host</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  p<span class="token punctuation">)</span>
    <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  g<span class="token punctuation">)</span>
    <span class="token assign-left variable">group</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  t<span class="token punctuation">)</span>
    <span class="token assign-left variable">tenant</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  u<span class="token punctuation">)</span>
    <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  w<span class="token punctuation">)</span>
    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  ?<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; USAGE OPTION: <span class="token variable">$0</span> [-h host] [-p port] [-g group] [-t tenant] [-u username] [-w password] &quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token keyword">esac</span>
<span class="token keyword">done</span>

<span class="token function-name function">urlencode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> \${#<span class="token number">1</span>}<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span>
  <span class="token keyword">do</span>
    <span class="token assign-left variable">char</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${1<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span>&quot;</span>
    <span class="token keyword">case</span> <span class="token variable">$char</span> <span class="token keyword">in</span>
    <span class="token punctuation">[</span>a-zA-Z0-9.~_-<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token builtin class-name">printf</span> <span class="token variable">$char</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span> <span class="token builtin class-name">printf</span> <span class="token string">&#39;%%%02X&#39;</span> <span class="token string">&quot;&#39;<span class="token variable">$char</span>&quot;</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${host}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">host</span><span class="token operator">=</span>localhost
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${port}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">8848</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${group}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">group</span><span class="token operator">=</span><span class="token string">&quot;SEATA_GROUP&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${tenant}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">tenant</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${username}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable">\${password}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">nacosAddr</span><span class="token operator">=</span><span class="token variable">$host</span><span class="token builtin class-name">:</span><span class="token variable">$port</span>
<span class="token assign-left variable">contentType</span><span class="token operator">=</span><span class="token string">&quot;content-type:application/json;charset=UTF-8&quot;</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;set nacosAddr=<span class="token variable">$nacosAddr</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;set group=<span class="token variable">$group</span>&quot;</span>

<span class="token assign-left variable">failCount</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">tempLog</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp <span class="token parameter variable">-u</span><span class="token variable">)</span></span>
<span class="token keyword">function</span> <span class="token function-name function">addConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-H</span> <span class="token string">&quot;<span class="token variable">\${contentType}</span>&quot;</span> <span class="token string">&quot;http://<span class="token variable">$nacosAddr</span>/nacos/v1/cs/configs?dataId=<span class="token variable"><span class="token variable">$(</span>urlencode $1<span class="token variable">)</span></span>&amp;group=<span class="token variable">$group</span>&amp;content=<span class="token variable"><span class="token variable">$(</span>urlencode $2<span class="token variable">)</span></span>&amp;tenant=<span class="token variable">$tenant</span>&amp;username=<span class="token variable">$username</span>&amp;password=<span class="token variable">$password</span>&quot;</span> <span class="token operator">&gt;</span><span class="token string">&quot;<span class="token variable">\${tempLog}</span>&quot;</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> <span class="token string">&quot;<span class="token variable">\${tempLog}</span>&quot;</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; Please check the cluster status. &quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
  <span class="token keyword">fi</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> <span class="token string">&quot;<span class="token variable">\${tempLog}</span>&quot;</span><span class="token variable">)</span></span> <span class="token operator">=~</span> <span class="token string">&quot;true&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Set <span class="token variable">$1</span>=<span class="token variable">$2</span> successfully &quot;</span>
  <span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Set <span class="token variable">$1</span>=<span class="token variable">$2</span> failure &quot;</span>
    <span class="token variable"><span class="token punctuation">((</span> failCount<span class="token operator">++</span> <span class="token punctuation">))</span></span>
  <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">line</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> <span class="token punctuation">$(</span>dirname <span class="token string">&quot;<span class="token environment constant">$PWD</span>&quot;</span><span class="token punctuation">)</span>/config.txt <span class="token operator">|</span> <span class="token function">sed</span> s/<span class="token punctuation">[</span><span class="token punctuation">[</span>:space:<span class="token punctuation">]</span><span class="token punctuation">]</span>//g<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token variable"><span class="token punctuation">((</span> count<span class="token operator">++</span> <span class="token punctuation">))</span></span>
	<span class="token assign-left variable">key</span><span class="token operator">=</span><span class="token variable">\${line<span class="token operator">%%</span>=*}</span>
    <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token variable">\${line<span class="token operator">#</span>*=}</span>
	addConfig <span class="token string">&quot;<span class="token variable">\${key}</span>&quot;</span> <span class="token string">&quot;<span class="token variable">\${value}</span>&quot;</span>
<span class="token keyword">done</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;=========================================================================&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; Complete initialization parameters,  total-count:<span class="token variable">$count</span> ,  failure-count:<span class="token variable">$failCount</span> &quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;=========================================================================&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">\${failCount}</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot; Init nacos config finished, please start seata-server. &quot;</span>
<span class="token keyword">else</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot; init nacos config fail. &quot;</span>
<span class="token keyword">fi</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-执行nacos-config-sh脚本将配置写到nacos" tabindex="-1"><a class="header-anchor" href="#_6-执行nacos-config-sh脚本将配置写到nacos" aria-hidden="true">#</a> 6.执行nacos-config.sh脚本将配置写到nacos</h2><h4 id="先使用chmod-x-nacos-config-sh-命令使其可执行" tabindex="-1"><a class="header-anchor" href="#先使用chmod-x-nacos-config-sh-命令使其可执行" aria-hidden="true">#</a> 先使用chmod +x nacos-config.sh 命令使其可执行</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./nacos-config.sh <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.0.153 <span class="token parameter variable">-p</span> <span class="token number">8848</span> <span class="token parameter variable">-g</span> SEATA_GROUP <span class="token parameter variable">-t</span> SEATA <span class="token parameter variable">-u</span> nacos <span class="token parameter variable">-w</span> nacos

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="注-命令解析-h-p-指定nacos的端口地址-g-指定配置的分组-注意-是配置的分组-t-指定命名空间id-u-w指定nacos的用户名和密码-同样-这里开启了nacos注册和配置认证的才需要指定。" tabindex="-1"><a class="header-anchor" href="#注-命令解析-h-p-指定nacos的端口地址-g-指定配置的分组-注意-是配置的分组-t-指定命名空间id-u-w指定nacos的用户名和密码-同样-这里开启了nacos注册和配置认证的才需要指定。" aria-hidden="true">#</a> 注：命令解析：-h -p 指定nacos的端口地址；-g 指定配置的分组，注意，是配置的分组；-t 指定命名空间id； -u -w指定nacos的用户名和密码，同样，这里开启了nacos注册和配置认证的才需要指定。</h5><h2 id="_7-到bin目录下启动seata服务" tabindex="-1"><a class="header-anchor" href="#_7-到bin目录下启动seata服务" aria-hidden="true">#</a> 7.到bin目录下启动seata服务</h2><p>后台启动命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">nohup</span> <span class="token function">sh</span> seata-server.sh <span class="token parameter variable">-h</span> <span class="token number">11.141</span>.230.153 <span class="token parameter variable">-p</span> <span class="token number">8091</span> <span class="token operator">&gt;</span> ./seata.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注：-h为服务器ip,不设置可能会默认使用局域网ip导致其他应用访问不到。-p为端口</p><h2 id="_8-客户端应用程序中seata配置" tabindex="-1"><a class="header-anchor" href="#_8-客户端应用程序中seata配置" aria-hidden="true">#</a> 8.客户端应用程序中seata配置</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># seata配置</span>
<span class="token key atrule">seata</span><span class="token punctuation">:</span>
  <span class="token comment"># 默认关闭，如需启用spring.datasource.dynami.seata需要同时开启</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment"># Seata 应用编号，默认为 \${spring.application.name}</span>
  <span class="token key atrule">application-id</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span>
  <span class="token comment"># Seata 事务组编号，用于 TC 集群名</span>
  <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span><span class="token punctuation">-</span>group
  <span class="token comment"># 关闭自动代理</span>
  <span class="token key atrule">enable-auto-data-source-proxy</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token comment"># 服务配置项</span>
  <span class="token key atrule">service</span><span class="token punctuation">:</span>
    <span class="token comment"># 虚拟组和分组的映射</span>
    <span class="token key atrule">vgroup-mapping</span><span class="token punctuation">:</span>
      <span class="token key atrule">jsxy-system-group</span><span class="token punctuation">:</span> default
    <span class="token comment"># 分组和 Seata 服务的映射</span>
    <span class="token comment"># grouplist:</span>
    <span class="token comment">#   default: 11.141.230.153:8091</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">serverAddr</span><span class="token punctuation">:</span> 192.168.0.151<span class="token punctuation">:</span><span class="token number">8848</span><span class="token punctuation">,</span>192.168.0.152<span class="token punctuation">:</span><span class="token number">8848</span><span class="token punctuation">,</span>192.168.0.153<span class="token punctuation">:</span><span class="token number">8848</span>
      <span class="token key atrule">group</span><span class="token punctuation">:</span> SEATA_GROUP
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> SEATA
      <span class="token key atrule">username</span><span class="token punctuation">:</span> nacos
      <span class="token key atrule">password</span><span class="token punctuation">:</span> nacos
  <span class="token key atrule">registry</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">application</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>server
      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.0.151<span class="token punctuation">:</span><span class="token number">8848</span><span class="token punctuation">,</span>192.168.0.152<span class="token punctuation">:</span><span class="token number">8848</span><span class="token punctuation">,</span>192.168.0.153<span class="token punctuation">:</span><span class="token number">8848</span>
      <span class="token key atrule">group</span><span class="token punctuation">:</span> SEATA_GROUP
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> SEATA
      <span class="token key atrule">username</span><span class="token punctuation">:</span> nacos
      <span class="token key atrule">password</span><span class="token punctuation">:</span> nacos
      <span class="token comment"># 可选  默认</span>
      <span class="token key atrule">cluster</span><span class="token punctuation">:</span> default 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23),u=[i,c,r];function d(v,k){return e(),t("div",null,u)}const b=a(o,[["render",d],["__file","index.html.vue"]]);export{b as default};
