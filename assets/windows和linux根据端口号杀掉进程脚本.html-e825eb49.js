import{_ as s,o as a,c as n,d as e}from"./app-ac465cee.js";const i={},l=e(`<h1 id="根据端口号杀掉进程脚本" tabindex="-1"><a class="header-anchor" href="#根据端口号杀掉进程脚本" aria-hidden="true">#</a> 根据端口号杀掉进程脚本</h1><h2 id="windows" tabindex="-1"><a class="header-anchor" href="#windows" aria-hidden="true">#</a> windows</h2><p>创建killport.bat，脚本内容如下</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>@echo off
<span class="token builtin class-name">set</span> <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">20002</span>
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=5&quot;</span> %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;netstat /ano | findstr %port%&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> taskkill /F /pid %%a
//for循环，提取第5个字段（从命令的结果中）赋予到变量a，并执行杀进程调用变量a
pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面那个脚本文件中端口号写死了，可以提取出来当成参数传递</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>@echo off
<span class="token builtin class-name">set</span> <span class="token assign-left variable">port</span><span class="token operator">=</span>%1
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=5&quot;</span> %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;netstat /ano | findstr %port%&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> taskkill /F /pid %%a
//for循环，提取第5个字段（从命令的结果中）赋予到变量a，并执行杀进程调用变量a
pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>调用方式：killport.bat 20002</p><h2 id="linux" tabindex="-1"><a class="header-anchor" href="#linux" aria-hidden="true">#</a> linux</h2><p>根据传入参数的端口号，杀掉进程killport脚本如下（文件名killport）</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># !/bin/bash  </span>
<span class="token comment"># Description: kill process by port  </span>
<span class="token comment"># Usage:       killport port  </span>
<span class="token comment"># example:     killport 8080</span>
<span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">netstat</span> <span class="token parameter variable">-tlnp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $7}&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;/&#39;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">\`</span></span>
<span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$pid</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将脚本文件killport放到/etc/init.d/文件夹下，也可以是其他的，脚本文件添加执行权限：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">chmod</span> +x /etc/init.d/killport
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>创建软连接</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/bin     
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/init.d/killport
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>调用方式：killport 20002<br> 中间可能会出现的错误：1、arguments must be process or job IDs 错误</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>下面代码 <span class="token operator">=</span> 后面 是 <span class="token variable"><span class="token variable">\`</span> ，这个字符是键盘上tab键上面的那个按键打出来的，如果不是可能会出现这个错误
<span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token variable">\`</span></span><span class="token function">netstat</span> <span class="token parameter variable">-tlnp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $7}&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;/&#39;</span> <span class="token string">&#39;{print $1}&#39;</span>\`
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>执行脚本出现No such file or directory错误出现这个错误的原因可能是文件格式的问题，因为在windows系统编写的文件格式是dos格式，linux系统需要使用unix格式1)、修改和查看文件格式命令用vim打开killport文件，执行查看文件格式命令：</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>:set ff 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>回车，显示fileformat=dos，需要重新设置文件格式，重新设置下文件格式命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>:set <span class="token assign-left variable">ff</span><span class="token operator">=</span>unix
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>保存并退出:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>:wq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,22),t=[l];function p(o,r){return a(),n("div",null,t)}const d=s(i,[["render",p],["__file","windows和linux根据端口号杀掉进程脚本.html.vue"]]);export{d as default};
