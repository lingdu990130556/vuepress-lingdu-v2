# æ’ä»¶





## ç•™è¨€æ¿
### ä¸‹è½½å®‰è£…
```shell
npm install --save vuepress-plugin-comment
npm install --save valine

or

yarn add vuepress-plugin-comment -D
yarn add valine -D
```
### æ³¨å†ŒLeanCloud
è¿›å…¥å®˜æ–¹ç½‘ç«™[LeanCloud](https://www.leancloud.cn/)ï¼Œæ³¨å†Œä½ è‡ªå·±çš„è´¦å·å¹¶ç™»å½•

åˆ›å»ºåº”ç”¨

![](./img/img_6.png)

æ‰¾åˆ°`AppID`å’Œ`AppKey`ç¨åä¼šç”¨åˆ°ï¼Œè¯¥æ­¥éª¤å¾ˆå…³é”®ã€‚

![](./img/img_7.png)

::: tip æç¤º
è¯„è®ºåˆ†ä¸ºä¸¤ç§ï¼Œå•é¡µé¢ä½¿ç”¨æˆ–è€…å¤šé¡µé¢ä½¿ç”¨
:::

- **å¤šé¡µé¢ä½¿ç”¨(ä¸æ¨è)**

  å¤šé¡µé¢ä½¿ç”¨çš„ç†è§£å°±æ˜¯ï¼šå½“ä½ åœ¨Config.jsä¸­é…ç½®å®Œæˆåï¼Œä½ çš„æ‰€æœ‰é¡µé¢éƒ½è‡ªåŠ¨è¢«å®‰æ’ä¸Šäº†ValineåŠŸèƒ½ï¼ŒåŒ…æ‹¬ä¸€äº›ä½ ä¸æƒ³è¦å®‰æ’çš„é¡µé¢ä¹Ÿè¢«å®‰æ’ä¸Šã€‚

å°† `vuepress-plugin-comment` æ·»åŠ åˆ°`vuepress`é¡¹ç›®çš„æ’ä»¶é…ç½®ä¸­ï¼š

```js
module.exports = {
    plugins: {
        'vuepress-plugin-comment': {
            choosen: 'valine',
            // optionsé€‰é¡¹ä¸­çš„æ‰€æœ‰å‚æ•°ï¼Œä¼šä¼ ç»™Valineçš„é…ç½®
            options: {
                el: '#valine-vuepress-comment',
                appId: 'Your own appId',
                appKey: 'Your own appKey'
            }
        }
    }
}

```

- **å•é¡µé¢ä½¿ç”¨(æ¨è)**

  å•é¡µé¢ä½¿ç”¨çš„ç†è§£å°±æ˜¯ï¼šå½“ä½ æŠŠåŸºç¡€é…ç½®çš„éƒ½é…ç½®å®Œæˆåï¼Œä½ æƒ³åœ¨å“ªä¸ªé¡µé¢æŒ‡å®šé…ç½®è¯„è®ºåŠŸèƒ½ï¼Œå°±å¯ä»¥åœ¨mdæ–‡ä»¶ä¸­å†™`<valine></valine>`æ¥è°ƒç”¨è¯„è®ºåŠŸèƒ½

**å•é¡µé¢é€šè¿‡ç»„ä»¶æ¥å®ç°åŠŸèƒ½**

.vuepress/config.jsé…ç½®æ–‡ä»¶ä¸­åŠ å…¥

```js
module.exports = {
    plugins: {
        '@vuepress/register-components': {
            componentsDir: './components'
        }
    }
}
```

:::tip æç¤º
è¿™æ˜¯è®¾ç½®è‡ªå®šä¹‰ç»„ä»¶çš„ä½ç½®ã€‚ç„¶ååœ¨.vuepress/componentsç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶Valine.vueï¼Œè¿™æ˜¯ç”¨äºè‡ªå®šä¹‰è‡ªå·±çš„ Valine ç»„ä»¶ã€‚
Valine.vue çš„æºç å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘å¼€å¯äº†é˜…è¯»é‡ç»Ÿè®¡ã€‚leancloud-visitorsç±»æ‰€åœ¨çš„å…ƒç´ çš„ id ä¼šç”¨æ¥è¯†åˆ«é¡µé¢æ‰€åœ¨ä½ç½®ã€‚
:::

```vue
<template>
  <section style="border-top: 2px solid #eaecef;padding-top:1rem;margin-top:2rem;">
    <div>
      <!-- id å°†ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ -->
      <span class="leancloud-visitors"
            data-flag-title="Your Article Title">
        <em class="post-meta-item-text">é˜…è¯»é‡ï¼š </em>
        <i class="leancloud-visitors-count"></i>
      </span>
    </div>
    <h3>
      <a href="javascript:;"></a>
      è¯„ è®ºï¼š
    </h3>
    <div id="vcomments"></div>
  </section>
</template>

<script>
export default {
  name: 'Valine',
  mounted: function () {
    // require window
    const Valine = require('valine');
    if (typeof window !== 'undefined') {
      document.getElementsByClassName('leancloud-visitors')[0].id
        = window.location.pathname
      this.window = window
      window.AV = require('leancloud-storage')
    }

    new Valine({
      el: '#vcomments',
      appId: 'XXXXXXXXXXXXX',// your appId
      appKey: 'XXXXXXXXXXXXX', // your appKey
      notify: false,
      verify: false,
      path: window.location.pathname,
      visitor: true,
      avatar: 'mm',
      placeholder: 'write here'
    });
  },
}
</script>

```
### ä½¿ç”¨

ç„¶ååœ¨ä½ æ‰€å†™çš„ md æ–‡ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªæ ‡ç­¾å°±è¡Œï¼Œæ¯”å¦‚åœ¨æœ€ä¸‹é¢ä¸€è¡Œé”®å…¥

`<Valine></Valine>`

æ•ˆæœï¼š

<Valine></Valine>

---


## å›¾ç‰‡æ”¾å¤§
:::warning æ³¨æ„
ä»…é€‚ç”¨äºvuepress v1.x
:::
[å®˜æ–¹æ–‡æ¡£](https://vuepress.vuejs.org/zh/plugin/official/plugin-medium-zoom.html)
### ä¸‹è½½å®‰è£…ä¾èµ–
```shell
npm install -D @vuepress/plugin-medium-zoom
```
### é…ç½®
#### ç®€å•ä½¿ç”¨:
```js
// .vuepresss/config.js
module.exports = {
    plugins: {
        '@vuepress/medium-zoom': {}
    }
}
```
#### è‡ªå®šä¹‰é€‰é¡¹:
```js
module.exports = {
  plugins: {
    '@vuepress/medium-zoom': {
      // selector: 'img.zoom-custom-imgs',
      // medium-zoom options here
      // See: https://github.com/francoischalifour/medium-zoom#options
      options: {
        margin: 16,                             // å¤–è¾¹è·
        background: 'rgba(255,255,255,0.39)',   // èƒŒæ™¯è‰²
        scrollOffset: 100                       // æ»‘åŠ¨å…³é—­åƒç´ 
      }
    }
  }
}
```
##### é€‰é¡¹
- **selector**
    - ç±»å‹: `string`
    - é»˜è®¤å€¼: `.theme-default-content :not(a) > img`  
      å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ `.theme-default-content` æ˜¯é»˜è®¤ä¸»é¢˜æ·»åŠ ç»™ `<Content />` ç»„ä»¶çš„ class nameã€‚
- **options**
    - ç±»å‹: `object`
    - é»˜è®¤å€¼: `undefined`

optionså‚æ•°å¦‚ä¸‹:

|å±æ€§|ç±»å‹|é»˜è®¤å€¼|æè¿°|  
|:--:|:-:|:--:|:-:|  
|margin|number|0|æ”¾å¤§å›¾åƒå¤–çš„ç©ºé—´|  
|background|string|#ff|å åŠ çš„èƒŒæ™¯|  
|scrollOffset|number|40|è¦æ»šåŠ¨ä»¥å…³é—­ç¼©æ”¾çš„åƒç´ æ•°|  
|container|string \|\| HTMLElementobject|null|è§†å›¾ç«¯å£ä»¥æ˜¾ç¤ºæ”¾å¤§|  
|template|string \|\| HTMLTemplateElement|null|ç¼©æ”¾æ—¶æ˜¾ç¤ºçš„æ¨¡æ¿å…ƒç´ |





---
## è®°å½•å½“å‰æµè§ˆçš„ä½ç½®ä¿¡æ¯
:::warning æ³¨æ„
ä»…é€‚ç”¨äºvuepress v1.x
:::
### ä»‹ç»

è¯¥æ’ä»¶åœ¨é¡µé¢å…³é—­æ—¶ï¼Œè®°å½•å½“å‰æµè§ˆçš„ä½ç½®ä¿¡æ¯ã€‚ç”¨æ¥åœ¨ä¸‹ä¸€æ¬¡è®¿é—®æ—¶ï¼Œå±•ç¤ºä¸€ä¸ªå‰å¾€è¯¥ä½ç½®çš„å¼¹çª—ã€‚

é»˜è®¤çš„å¼¹çª—æ ·å¼ä¸ [@vuepress/plugin-pwa](https://github.com/vuejs/vuepress/tree/master/packages/%40vuepress/plugin-pwa) ä¸€æ ·ã€‚

---

### å®‰è£…

``` sh
yarn add vuepress-plugin-last-reading
## or
npm i vuepress-plugin-last-reading
```

### ä½¿ç”¨

``` js
module.exports = {
  plugins: [
    'last-reading'
  ]
}
```

### é€‰é¡¹

#### popupConfig
- ç±»å‹: `Object`
- å¿…é¡»: `false`

å¼¹å‡ºç»„ä»¶ä¸­æ˜¾ç¤ºçš„é»˜è®¤æç¤ºæ–‡æœ¬å†…å®¹ã€‚

``` js
module.exports = {
  plugins: [
    ['last-reading', {
      popupConfig: {
        message: 'è¿”å›ä¹‹å‰ä½ç½®',
        buttonText: 'ç¡®å®š'
      },
    }]
  ]
}
```

æˆ–è€…å‚è€ƒ [i18n](../../src/i18n.js) é…ç½®å¤šè¯­è¨€ã€‚

#### popupCountdown
- ç±»å‹: `Number`
- é»˜è®¤å€¼: `10000`
- å¿…é¡»: `false`

é…ç½®å¼¹çª—æ˜¾ç¤ºçš„æ—¶é—´ã€‚

#### popupComponent
- ç±»å‹: `string`
- å¿…é¡»: `false`

ç”¨äºæ›¿æ¢é»˜è®¤å¼¹å‡ºç»„ä»¶çš„è‡ªå®šä¹‰ç»„ä»¶ï¼Œå‚è€ƒ[è‡ªå®šä¹‰å¼¹çª—æ ·å¼](#è‡ªå®šä¹‰å¼¹çª—æ ·å¼)ã€‚

#### popupCustom
- ç±»å‹: `Function`
- å¿…é¡»: `false`

è‡ªå®šä¹‰å¼¹çª—ç›¸å…³é€»è¾‘ã€‚

::: tip
å¦‚æœé…ç½®è¯¥é€‰é¡¹ï¼Œè¯·é€šè¿‡ä¸‹é¢æ–¹å¼å®šä¹‰å‡½æ•°
:::

``` js
module.exports = {
  plugins: [
    ['last-reading', {
      popupCustom: function() {
        const now = new Date().getTime()
        if (now - this.lastReading.timestamp > 30 * 24 * 60 *60 * 1000) {
          this.clean()
        } else if (this.$route.path === this.lastReading.path) {
          this.goto()
        } else {
          this.show = true
          setTimeout(this.clean, 10000)
        }
      },
    }]
  ]
}
```

### è‡ªå®šä¹‰å¼¹çª—æ ·å¼

é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨ `.vuepress/components` ä¸­åˆ›å»ºä¸€ä¸ªå…¨å±€ç»„ä»¶ (ä¾‹å¦‚ `MyPopup`)ã€‚ ä¸€ä¸ªåŸºäºé»˜è®¤ç»„ä»¶åˆ›å»ºçš„ç®€å•ç»„ä»¶å¦‚ä¸‹ï¼š

``` vue
<template>
  <LastReadingPopup v-slot="{ show, goto, message, buttonText }">
    <div v-if="show" class="my-sw-update-popup">
      {{ message }}<br>
      <button @click="goto">{{ buttonText }}</button>
    </div>
  </LastReadingPopup>
</template>
<script>
import LastReadingPopup from 'vuepress-plugin-last-reading/src/LastReadingPopup.vue'
export default {
  components: { LastReadingPopup }
}
</script>
<style>
.my-sw-update-popup {
  text-align: right;
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #fff;
  font-size: 20px;
  padding: 10px;
  border: 5px solid #3eaf7c;
}
.my-sw-update-popup button {
  border: 1px solid #fefefe;
}
</style>
```

æ¥ç€ï¼Œæ›´æ–°ä½ çš„æ’ä»¶é…ç½®ï¼š

``` js
module.exports = {
  plugins: [
    ['last-reading', {
      popupComponent: 'MyPopup'
    }]
  ]
}
```
---

## é˜…è¯»è¿›åº¦æ¡
:::warning æ³¨æ„
ä»…é€‚ç”¨äºvuepress v1.x
:::
[vuepress-plugin-reading-progress](https://github.com/tolking/vuepress-plugin-reading-progress)

## é¢å‘ VuePress2 çš„å¸¸ç”¨ç»„ä»¶

vuepress-plugin-components  

### å®‰è£…
<CodeGroup>
  <CodeGroupItem title="pnpm" active>

```pnpm
pnpm add -D vuepress-plugin-components
```

  </CodeGroupItem>
  <CodeGroupItem title="yarn">
  
```yarn
yarn add -D vuepress-plugin-components
```

  </CodeGroupItem>
  <CodeGroupItem title="npm">
  
```npm
npm i -D vuepress-plugin-components
```

  </CodeGroupItem>
</CodeGroup>

### ä½¿ç”¨

<CodeGroup>
  <CodeGroupItem title="TS" active>

```ts
// .vuepress/config.ts
import { componentsPlugin } from "vuepress-plugin-components";

export default {
  plugins: [
    componentsPlugin({
      // æ’ä»¶é€‰é¡¹
    }),
  ],
};

```

  </CodeGroupItem>
  <CodeGroupItem title="JS">

```js
// .vuepress/config.js
import { componentsPlugin } from "vuepress-plugin-components";

export default {
  plugins: [
    componentsPlugin({
      // æ’ä»¶é€‰é¡¹
    }),
  ],
};

```

  </CodeGroupItem>
</CodeGroup>

### [å®˜æ–¹æ–‡æ¡£](https://plugin-components.vuejs.press/zh/)

### å…¬å‘Šçª—æ”¹è£…æˆéŸ³ä¹æ’­æ”¾å™¨
:::tip æè¿°
åˆ©ç”¨å…¬å‘Šæ’ä»¶åµŒå…¥ç½‘æ˜“äº‘éŸ³ä¹<br>
![](./img/img_11.png =x300)
:::
#### 1.å¼€å¯å…¬å‘Šçª—å£
```ts
import { componentsPlugin } from "vuepress-plugin-components";

export default {
  plugins: [
    componentsPlugin({
      // å…¬å‘Šæ’ä»¶
      rootComponents: {
        notice: [
          {
            path: "/",
            title: '<div id="lingdu-tishi"><button id="btnMove" type="button" class="notice-footer-action primary">ã€‡Â°</button></div>',
            // content: "Notice Content",// å†…å®¹ è¿™é‡ŒåµŒå…¥ç½‘æ˜“äº‘æ’­æ”¾å™¨
            content: "<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=100% height=450 src=\"//music.163.com/outchain/player?type=0&id=5163968960&auto=1&height=430\"></iframe>",
            // å…³é—­å…¨å±æ˜¾ç¤º
            fullscreen: false,
            // éœ€è¦ç¡®è®¤æ‰å…³é—­å¦åˆ™å»¶æ—¶å…³é—­
            confirm: true,
          },
        ],
      },
    }),
  ],
};

```
#### 2.æ·»åŠ è„šæœ¬ä½¿çª—å£æœ€å°åŒ–
åœ¨`.vuepress/public/js`ä¸‹åˆ›å»º`gonggao.js`
:::: details gonggao.jsä»£ç 
```js
/**
 * å»¶è¿Ÿ 4000 æ¯«ç§’åæ‰§è¡Œ showMessage å‡½æ•° ã€è¿™é‡Œç”¨ä¸€ä¸ªå¯¹è±¡æ¥æ”¶å°±ä¼šåªæ‰§è¡Œä¸€æ¬¡ï¼Œå¦åˆ™è·³è½¬é¡µé¢ä¼šæ‰§è¡Œå¤šæ¬¡ã€‘
 */
const constResize=setTimeout(resize, 4000);

/**
 * è°ƒæ•´å¤§å°
 */
function resize() {
  let myDiv;
  let ok=false;
  let x = 100, y = 100, h; // åˆå§‹ä½ç½®
  let timer;
  let status = 1;// çŠ¶æ€é»˜è®¤1ä¸ºæœ€å¤§åŒ–ï¼Œ0ä¸ºæœ€å°åŒ–

  myDiv = document.getElementsByClassName("notice-wrapper")[0];
  const initialLeft = parseInt(myDiv.getBoundingClientRect().left); // è·å– myDiv å…ƒç´ çš„åˆå§‹æ°´å¹³ä½ç½®
  const initialTop = parseInt(myDiv.getBoundingClientRect().top); // è·å– myDiv å…ƒç´ çš„åˆå§‹å‚ç›´ä½ç½®
  const initialH = parseInt(myDiv.getBoundingClientRect().height); // è·å– myDiv å…ƒç´ çš„åˆå§‹é«˜
  x = initialLeft
  y = initialTop; // åˆå§‹ä½ç½®
  h = initialH; // åˆå§‹é«˜åº¦

  const tishi = document.getElementById("lingdu-tishi");
  tishi.innerHTML +="<span style='color: #282c34'>ğŸ‘ˆç‚¹å‡»æŒ‰é’®æœ€å°åŒ–</span>";

  const btnMove = document.getElementById("btnMove");

  // btnMove.onclick = delayedMove;
  /**
   * ç›‘æµ‹ç‚¹å‡»æŒ‰é’®äº‹ä»¶
   */
  btnMove.onclick = function () {
    // console.log("ç‚¹å‡»äº†ã€‚ã€‚ã€‚")
    if(!ok){
      return;
    }
    if (status === 1) {
      timer = setInterval(moveDiv, 0); // ç‚¹å‡»æŒ‰é’®åï¼Œæ¯éš” 50 æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ç§»åŠ¨æ“ä½œ
      status = 0
    } else {
      timer = setInterval(moveDiv2, 0); // ç‚¹å‡»æŒ‰é’®åï¼Œæ¯éš” 50 æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ç§»åŠ¨æ“ä½œ
      status = 1

    }
  };
  ok=true;

  /**
   * æœ€å°åŒ–
   */
  function moveDiv() {
    x += 2; // æ¯æ¬¡å‘å³ç§»åŠ¨ 10 ä¸ªåƒç´ 
    myDiv.style.left = x + "px"; // è®¾ç½®æ°´å¹³ä½ç½®

    y += 4; // æ¯æ¬¡å‘ä¸‹ç§»åŠ¨ 5 ä¸ªåƒç´ 
    myDiv.style.top = y + "px"; // è®¾ç½®å‚ç›´ä½ç½®

    h += -4;
    myDiv.style.height = h + "px";
    // è°ƒæ•´é€æ˜åº¦
    myDiv.style.opacity = 0.3;

    if (x - initialLeft >= 225) { // å¦‚æœè¾¾åˆ°æ‰§è¡Œæ¬¡æ•°ä¸Šé™ï¼Œåœæ­¢å®šæ—¶å™¨
      clearInterval(timer);
    }
  }

  /**
   * è¿˜åŸ
   */
  function moveDiv2() {
    x += -2; // æ¯æ¬¡å‘å³ç§»åŠ¨ 10 ä¸ªåƒç´ 
    myDiv.style.left = x + "px"; // è®¾ç½®æ°´å¹³ä½ç½®

    y += -4; // æ¯æ¬¡å‘ä¸‹ç§»åŠ¨ 5 ä¸ªåƒç´ 
    myDiv.style.top = y + "px"; // è®¾ç½®å‚ç›´ä½ç½®

    h += 4;
    myDiv.style.height = h + "px";
    // è°ƒæ•´é€æ˜åº¦
    myDiv.style.opacity = 1;

    if (x - initialLeft <= 0) { // å¦‚æœè¾¾åˆ°æ‰§è¡Œæ¬¡æ•°ä¸Šé™ï¼Œåœæ­¢å®šæ—¶å™¨
      clearInterval(timer);
    }
  }

}

```
::::

#### 3. ä½¿è„šæœ¬ç”Ÿæ•ˆ
åœ¨config.tsä¸­é…ç½®é¡¹è¿½åŠ `head`é¡¹
```ts
// .vuepress/config.ts

// é…ç½®
import {head, navbarMy, sidebarMy} from './configs';
export default ({
  head,
})
```
æˆ‘è¿™é‡Œ`head`æ˜¯å¼•ç”¨è¿›æ¥çš„  
`head.ts`ä¸­è¿½åŠ 
```ts
import type { HeadConfig } from '@vuepress/core'

const name='/vuepress-lingdu-v2'

export const head: HeadConfig[] = [
  // æ·»åŠ æµè§ˆå™¨å›¾æ ‡
  ['link',{rel: 'icon',type: 'image/png',sizes: '16x16',href: `/vuepress-lingdu-v2/img/logo.png`,},],
  ['link',{rel: 'icon',type: 'image/png',sizes: '32x32',href: `/vuepress-lingdu-v2/img/logo.png`,},],
  ['link', { rel: 'manifest', href: '/manifest.webmanifest' }],
  ['meta', { name: 'application-name', content: 'VuePress' }],
  ['meta', { name: 'apple-mobile-web-app-title', content: 'VuePress' }],
  ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],
  ['link',{ rel: 'apple-touch-icon', href: `/images/icons/apple-touch-icon.png` },],
  ['link',{rel: 'mask-icon',href: '/images/icons/safari-pinned-tab.svg',color: '#3eaf7c',},],
  ['meta', { name: 'msapplication-TileColor', content: '#3eaf7c' }],
  ['meta', { name: 'theme-color', content: '#3eaf7c' }],

  ['script', { src: '/vuepress-lingdu-v2/js/gonggao.js' }]// è¿½åŠ é¡¹ å¼•å…¥js
]

```
<h1>
<Badge text="æ¼”ç¤º" />
</h1>

<BiliBili bvid="BV1ym4y1i78E" />

